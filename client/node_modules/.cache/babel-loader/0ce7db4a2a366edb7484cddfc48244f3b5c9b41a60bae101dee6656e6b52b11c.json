{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { UsersData } from \"../Exampledata\";\nimport axios from \"axios\";\nconst initialState = {\n  user: null,\n  isLoading: false,\n  isSuccess: false,\n  isError: false\n};\nexport const updateUserProfile = createAsyncThunk(\"user/updateUserProfile\", async userData => {\n  try {\n    const formData = new FormData();\n    formData.append(\"email\", userData.email);\n    formData.append(\"name\", userData.name);\n    formData.append(\"password\", userData.password);\n    if (userData.profilePic) {\n      formData.append(\"profilePic\", userData.profilePic);\n    }\n    const response = await axios.put(`http://localhost:3001/updateUserProfile/${userData.email}`, formData);\n    return response.data.user;\n  } catch (error) {\n    console.log(error);\n    throw error;\n  }\n});\nexport const logout = createAsyncThunk(\"/users/logout\", async () => {\n  try {\n    // Send a request to your server to log the user out\n    const response = await axios.post(\"http://localhost:3001/logout\");\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const registerUser = createAsyncThunk(\"users/registerUser\", async userData => {\n  try {\n    //sends a POST request to the server along the request body object\n    const response = await axios.post(\"http://localhost:3001/registerUser\", {\n      name: userData.name,\n      email: userData.email,\n      password: userData.password\n    });\n    console.log(response);\n    const user = response.data.user; //retrieve the response from the server\n    return user; //return the response from the server as payload to the thunk\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const login = createAsyncThunk(\"users/login\", async userData => {\n  try {\n    const response = await axios.post(\"http://localhost:3001/login\", {\n      email: userData.email,\n      password: userData.password\n    });\n    const user = response.data.user;\n    console.log(response);\n    return user;\n  } catch (error) {\n    //handle the error\n    const errorMessage = \"Invalid credentials\";\n    alert(errorMessage);\n    throw new Error(errorMessage);\n  }\n});\nexport const userSlice = createSlice({\n  name: \"users\",\n  initialState,\n  reducers: {\n    addUser: (state, action) => {\n      state.value.push(action.payload);\n    },\n    deleteUser: (state, action) => {\n      state.value = state.value.filter(user => user.email != action.payload);\n    },\n    updateUsers: (state, action) => {\n      const idx = state.value.findIndex(user => user.email === action.payload.email);\n      if (idx !== -1) {\n        state.value[idx] = {\n          ...state.value[idx],\n          ...action.payload\n        };\n      }\n    }\n  },\n  extraReducers: builder => {\n    //Asynchronous actions that update the state directly,\n    builder.addCase(registerUser.pending, state => {\n      state.isLoading = true;\n    }).addCase(registerUser.fulfilled, (state, action) => {\n      state.isLoading = true;\n    }).addCase(registerUser.rejected, state => {\n      state.isLoading = false;\n    }).addCase(login.pending, state => {\n      state.isLoading = true;\n    }).addCase(login.fulfilled, (state, action) => {\n      state.user = action.payload;\n      state.isLoading = false;\n      state.isSuccess = true;\n    }).addCase(login.rejected, state => {\n      state.isLoading = false;\n      state.isError = true;\n    }).addCase(logout.pending, state => {\n      state.isLoading = true;\n    }).addCase(logout.fulfilled, state => {\n      state.user = null; // <-- set to null\n      state.isLoading = false;\n      state.isSuccess = false;\n    }).addCase(logout.rejected, state => {\n      state.isLoading = false;\n      state.isError = true;\n    }).addCase(updateUserProfile.pending, state => {\n      state.isLoading = true;\n    }).addCase(updateUserProfile.fulfilled, (state, action) => {\n      state.user = action.payload;\n      state.isLoading = false;\n    }).addCase(updateUserProfile.rejected, state => {\n      state.isLoading = false;\n      state.isError = true;\n    });\n  }\n});\nexport const {\n  addUser,\n  deleteUser,\n  updateUsers\n} = userSlice.actions;\nexport default userSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","UsersData","axios","initialState","user","isLoading","isSuccess","isError","updateUserProfile","userData","formData","FormData","append","email","name","password","profilePic","response","put","data","error","console","log","logout","post","registerUser","login","errorMessage","alert","Error","userSlice","reducers","addUser","state","action","value","push","payload","deleteUser","filter","updateUsers","idx","findIndex","extraReducers","builder","addCase","pending","fulfilled","rejected","actions","reducer"],"sources":["C:/Users/36s2023/Desktop/Location Based/client/src/Features/UserSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\r\nimport { UsersData } from \"../Exampledata\";\r\nimport axios from \"axios\"; \r\n\r\nconst initialState = {\r\n  user: null,\r\n  isLoading: false,\r\n  isSuccess: false,\r\n  isError: false,\r\n};\r\n\r\nexport const updateUserProfile = createAsyncThunk(\r\n  \"user/updateUserProfile\",\r\n  async (userData) => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"email\", userData.email);\r\n      formData.append(\"name\", userData.name);\r\n      formData.append(\"password\", userData.password);\r\n      if (userData.profilePic) {\r\n        formData.append(\"profilePic\", userData.profilePic);\r\n      }\r\n\r\n      const response = await axios.put(\r\n        `http://localhost:3001/updateUserProfile/${userData.email}`,\r\n        formData\r\n      );\r\n\r\n      return response.data.user;\r\n    } catch (error) {\r\n      console.log(error);\r\n      throw error;\r\n    }\r\n  }\r\n);\r\n\r\n\r\nexport const logout = createAsyncThunk(\"/users/logout\", async () => {\r\n  try {\r\n    // Send a request to your server to log the user out\r\n    const response = await axios.post(\"http://localhost:3001/logout\");\r\n  } \r\n  catch (error) {\r\n    console.log(error);\r\n  }\r\n});\r\n\r\nexport const registerUser = createAsyncThunk(\r\n  \"users/registerUser\",\r\n  async (userData) => {\r\n    try {\r\n      //sends a POST request to the server along the request body object\r\n      const response = await axios.post(\"http://localhost:3001/registerUser\", {\r\n        name: userData.name,\r\n        email: userData.email,\r\n        password: userData.password,\r\n      });\r\n      console.log(response);\r\n      const user = response.data.user; //retrieve the response from the server\r\n      return user; //return the response from the server as payload to the thunk\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n);\r\nexport const login = createAsyncThunk(\"users/login\", async (userData) => {\r\n  try {\r\n    const response = await axios.post(\"http://localhost:3001/login\", {\r\n      email: userData.email,\r\n      password: userData.password,\r\n    });\r\n\r\n    const user = response.data.user;\r\n    console.log(response);\r\n    return user;\r\n  } catch (error) {\r\n    //handle the error\r\n    const errorMessage = \"Invalid credentials\";\r\n    alert(errorMessage);\r\n    throw new Error(errorMessage);\r\n  }\r\n});\r\n\r\nexport const userSlice = createSlice(\r\n    {\r\n        name:\"users\",\r\n        initialState,\r\n        reducers:{\r\n                addUser:(state,action)=>\r\n                {\r\n                    state.value.push(action.payload);\r\n                },\r\n                deleteUser:(state,action)=>\r\n                {\r\n                    state.value = state.value.filter((user)=>\r\n                        user.email !=action.payload);\r\n                },\r\n                updateUsers: (state, action) => {\r\n                    \r\n                    const idx = state.value.findIndex(\r\n                      (user) => user.email === action.payload.email\r\n                    );\r\n                    if (idx !== -1) {\r\n                      \r\n                      state.value[idx] = { ...state.value[idx], ...action.payload };\r\n                    }\r\n                  },\r\n  },\r\n  extraReducers: (builder) => {\r\n    //Asynchronous actions that update the state directly,\r\n    builder\r\n      .addCase(registerUser.pending, (state) => {\r\n        state.isLoading = true;\r\n      })\r\n      .addCase(registerUser.fulfilled, (state, action) => {\r\n        state.isLoading = true;\r\n      })\r\n      .addCase(registerUser.rejected, (state) => {\r\n        state.isLoading = false;\r\n      })\r\n      .addCase(login.pending, (state) => {\r\n        state.isLoading = true;\r\n      })\r\n      .addCase(login.fulfilled, (state, action) => {\r\n        state.user = action.payload; \r\n        state.isLoading = false;\r\n        state.isSuccess = true;\r\n      })\r\n      .addCase(login.rejected, (state) => {\r\n        state.isLoading = false;\r\n        state.isError = true;\r\n      })\r\n      .addCase(logout.pending, (state) => {\r\n        state.isLoading = true;\r\n      })\r\n      .addCase(logout.fulfilled, (state) => {\r\n        state.user = null;   // <-- set to null\r\n        state.isLoading = false;\r\n        state.isSuccess = false;\r\n      })\r\n      .addCase(logout.rejected, (state) => {\r\n        state.isLoading = false;\r\n        state.isError = true;\r\n      })\r\n      .addCase(updateUserProfile.pending, (state) => {\r\n        state.isLoading = true;\r\n      })\r\n      .addCase(updateUserProfile.fulfilled, (state, action) => {\r\n        state.user = action.payload;\r\n        state.isLoading = false;\r\n      })\r\n      .addCase(updateUserProfile.rejected, (state) => {\r\n        state.isLoading = false;\r\n        state.isError = true;\r\n      });\r\n\r\n\r\n},\r\n\r\n});\r\nexport const {addUser,deleteUser,updateUsers} = userSlice.actions;\r\nexport default userSlice.reducer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}